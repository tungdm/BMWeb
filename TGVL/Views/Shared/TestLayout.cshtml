<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THẾ GIỚI VẬT LIỆU</title>
    @Styles.Render("~/Content/css")
    @Styles.Render("~/Content/mainpagecss")
    @*@Scripts.Render("~/bundles/mainpagejquery")*@
    @Styles.Render("~/Content/notification")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/otf2")
    <script src="~/Scripts/sweetalert2.js"></script>
    <link href="~/Content/sweetalert2.css" rel="stylesheet" />
    
    <style>
        body {
            font-family: Roboto, sans-serif;
        }

        #top-header {
            background: #F3F3F3;
            border-bottom: 2px solid #FFFFFF;
            height: 35px;
        }

        #searchForm {
            width: 85%;
            padding: 11px 20px;
            font-size: 14px;
        }
    </style>

</head>
@using Microsoft.AspNet.Identity
<body class="cms-index-index">
    @{
        if (Session["UnSeenNoti"] != null)
        {
            ViewData["UnSeenNoti"] = Session["UnSeenNoti"];
        }
    }
    <div class="page">
        <!-- Header -->
        <header class="header-container">
            <div id="top-header" class="header-top">
                <div class="navbar navbar-inverse navbar-fixed-top" style="background-color: #f6f6f6">
                    <div class="container">
                        <div class="navbar-header">
                        </div>
                        <div class="navbar-collapse collapse">
                            <ul class="nav navbar-nav" style="width: 300px;float: right;">
                                @*Chỉnh header float right*@
                                <li>@Html.Partial("_LoginPartial")</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <br />
            @Html.Partial("_SearchPartial")
        </header>
        <!-- end header -->
        <!-- Navbar -->
        <nav>
            <div class="container">
                <div class="nav-inner">
                    <ul id="nav" class="hidden-xs">
                        
                        <li class="level0 parent drop-menu">
                            <a href="/Home"><span><strong>Trang chủ</strong></span></a>
                        </li>
                        <li class="level0 parent drop-menu">
                            <a href="/Home/About"><span><strong>Giới thiệu</strong></span></a>
                        </li>
                        <li class="level0 parent drop-menu">
                            <a href="/Home/Instruction"><span><strong>Hướng dẫn</strong></span></a>
                            @*<ul style="display: none;" class="level1">
                                <li class="level1 nav-10-2"> <a href="list.html"> <span>Hướng dẫn đấu thầu</span> </a> </li>
                                <li class="level1 nav-10-3"> <a href="product_detail.html"> <span>Hướng dẫn mua hàng</span> </a> </li>
                            </ul>*@
                        </li>
                        <li class="level0 parent drop-menu">
                            <a href="/Home/Policy"><span><strong>Chính sách</strong></span></a>
                            @*<ul style="display: none;" class="level1">
                                <li class="level1 nav-10-2"> <a href="list.html"> <span>Chính sách đấu thầu</span> </a> </li>
                                <li class="level1 nav-10-3"> <a href="product_detail.html"> <span>Chính sách mua hàng</span> </a> </li>
                            </ul>*@
                        </li>
                        <li class="level0 parent drop-menu">
                            <a href="/Home/Contact"><span><strong>Liên hệ</strong></span></a>
                        </li>
                    </ul>

                </div>
            </div>
        </nav>

        @RenderBody()
        <!-- End main container -->
        <!-- Footer -->
        <footer class="footer">
            <div class="footer-middle">
                <div class="container">
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-4 col-xs-12">
                            <h2 style="font-size:16px"><strong>Giới thiệu</strong></h2>
                            <ul class="links">
                                <li class="first"><a href="/Home/About" style="font-size:16px">Về chúng tôi</a></li>
                                <li class="first"><a href="/Home/Blog" style="font-size:16px">Blog</a></li>
                                @*<li><a href="#" style="font-size:16px">Liên hệ- Hợp tác</a></li>
                                <li><a href="#" style="font-size:16px"></a></li>*@
                            </ul>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-4 col-xs-12">
                            <h2 style="font-size:16px"><strong>Hỗ trợ khách hàng</strong></h2>
                            <ul class="links">
                                <li class="first"><a href="#" style="font-size:16px">Hướng dẫn mua hàng</a></li>
                                <li class="first"><a href="#" style="font-size:16px">Hướng dẫn đấu thầu</a></li>
                                <li class="first"><a href="/Home/Question" style="font-size:16px">Câu hỏi thường gặp</a></li>
                            </ul>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-4 col-xs-12">
                            <h2 style="font-size:16px"><strong>Quy định</strong></h2>
                            <ul class="links">
                                <li class="first"><a href="#" style="font-size:16px">Chính sách mua hàng</a></li>
                                <li><a href="faq.html" style="font-size:16px">Chính sách đấu thầu</a></li>
                                <li><a href="#" style="font-size:16px">Điều khoản sử dụng</a></li>
                            </ul>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-4 col-xs-12">
                            <h2 style="font-size:16px"><strong>Liên hệ</strong></h2>
                            <ul class="links">
                                <li><a href="#" style="font-size:16px"><strong>(08)-3877-0508</strong> </a></li>
                                <li><a href="#" style="font-size:16px"><strong>thegioivatlieu123@gmail.com</strong> </a></li>
                            </ul>

                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-4 col-xs-12 coppyright"> &copy; 2017 © BMW</div>

                    </div>
                </div>
            </div>
        </footer>
        <!-- End Footer -->

    </div>



    <div id="messageModal" class="modal fade" role="dialog">
        <div class="modal-dialog" style="left:0%">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Message</h4>
                </div>
                <div class="modal-body" style="min-height:calc(100vh - 210px);max-height: calc(100vh - 210px);overflow-y: auto;">
                    <div id="message"></div>
                </div>
                @*<div class="modal-footer">
                        <input type="button" value="Hoàn tất" class="btn btn-success" id="submit-btn-reply" style="display:none" />
                        <input type="button" value="Hoàn tất" class="btn btn-success" id="submit-btn-edit" style="display:none" />
                        <button type="button" class="btn btn-default" data-dismiss="modal">Đóng</button>
                    </div>*@
            </div>

        </div>
    </div>

</body>


</html>

@Scripts.Render("~/bundles/signalR")
@Scripts.Render("~/signalr/hubs")

@RenderSection("scripts", required: false)


<script>
    $(document).ready(function () {
        
        var count = parseInt($('div.count').html()) || 0;

        //$('span.count').html(count);

        // ANIMATEDLY DISPLAY THE NOTIFICATION COUNTER.
        if (count != 0) {
            $('#noti_Counter')
            .css({ opacity: 0 })
            .text(count)
            .css({ top: '-10px' })
            .animate({ top: '10px', opacity: 1 }, 500)
            .fadeIn('slow');
        }

        $(document).ajaxStart(function () {
            NProgress.start();
        });
        $(document).ajaxStop(function () {
            NProgress.done();
        });

        if (window.location.hash != null && window.location.hash != '') {

            $('html, body').animate({
                scrollTop: $(window.location.hash).offset().top
            }, 1500);
        }

        var controllerName = '@ViewContext.RouteData.Values["Controller"].ToString()';
        var actionName = '@ViewContext.RouteData.Values["Action"].ToString()';
        var requestId = '@ViewContext.RouteData.Values["id"]';
        var userName = '@User.Identity.GetUserName()';

        // signalr js code for start hub and send receive notification
        var notificationHub = $.connection.notificationHub;
        $.connection.hub.start().done(function () {
            //notificationHub.server.joinGroup("@User.Identity.GetUserName()");

            console.log('Notification hub started');
        });

        notificationHub.client.broadcastMessage = function (message, requestId, newreplyId) {
            if (message && message.toLowerCase() === "updatereplytable") {
                console.log('Update client reply:' + requestId);
                updateClientReplyTable(controllerName, actionName, requestId, userName, newreplyId);
            }

            if (message && message.toLowerCase() === "updatereplytable2") {
                console.log('Update client reply2:' + requestId);
                updateClientReplyTable2(controllerName, actionName, requestId, userName, newreplyId);
            }

            
        }

        notificationHub.client.broadcastMessageDeal = function (message, dealId, newQuantity, newNumBuyer) {
            if (message && message.toLowerCase() === "updatedealquantity") {
                
                if (controllerName === 'Deal' && actionName === 'Details' && requestId == dealId) {
                    console.log("updateDealQuantity");
                    $("#quantity-remain").html(newQuantity);
                    $("#num-buyer").html(newNumBuyer);
                }
            }
        }

        //signalr method for push server message to client
        notificationHub.client.notify = function (message) {
            if (message && message.toLowerCase() === "added") {
                console.log('updateNotificationCount from homepage layout Method 2');
                updateNotificationCount(controllerName, actionName, requestId, userName);
            }

            if (message && message.toLowerCase() === "newreplyadded") {
                console.log('new reply added');
                updateNotificationCount(controllerName, actionName, requestId, userName);
            }

            if (message && message.toLowerCase() === "update") { //supplier update bid table
                console.log('Supplier update bid table');
                updateBidTable(controllerName, actionName, requestId);
            }

            if (message && message.toLowerCase() === "updatebidtable") { //customer update bid table
                console.log('Customer update bid table');
                updateCustomerBidTable(controllerName, actionName, requestId);
            }

            if (message && message.toLowerCase() === "updatereplytable") { //supplier update reply table
                console.log('updatereplytable');
                updateSupplierReplyTable(controllerName, actionName, requestId, userName);

            }

            if (message && message.toLowerCase() === "expired") {
                console.log('expired');
                showExpired();
            }

            if (message && message.toLowerCase() === "expiredoutside") {
                console.log('expiredOutside');
                ExpiredOutside();
            }

            if (message && message.toLowerCase() === "winner") {
                console.log('winner');
                updateNotificationCount();
            }
        };

    });


</script>





